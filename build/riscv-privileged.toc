\contentsline {chapter}{Preface}{i}{Doc-Start}%
\contentsline {chapter}{\numberline {第一章\hspace {.3em}} 介绍 }{1}{chapter.1}%
\contentsline {section}{\numberline {1.1}RISC-V Privileged Software Stack Terminology}{1}{section.1.1}%
\contentsline {section}{\numberline {1.2}Privilege Levels}{4}{section.1.2}%
\contentsline {section}{\numberline {1.3}Debug Mode}{6}{section.1.3}%
\contentsline {chapter}{\numberline {第二章\hspace {.3em}}Control and Status Registers (CSRs)}{7}{chapter.2}%
\contentsline {section}{\numberline {2.1}CSR Address Mapping Conventions}{8}{section.2.1}%
\contentsline {section}{\numberline {2.2}CSR Listing}{9}{section.2.2}%
\contentsline {section}{\numberline {2.3}CSR Field Specifications}{16}{section.2.3}%
\contentsline {section}{\numberline {2.4}CSR Field Modulation}{18}{section.2.4}%
\contentsline {section}{\numberline {2.5}Implicit Reads of CSRs}{18}{section.2.5}%
\contentsline {section}{\numberline {2.6}CSR Width Modulation}{19}{section.2.6}%
\contentsline {chapter}{\numberline {第三章\hspace {.3em}}机器级 ISA, 1.12版本}{21}{chapter.3}%
\contentsline {section}{\numberline {3.1}机器级 CSRs}{21}{section.3.1}%
\contentsline {subsection}{\numberline {3.1.1}机器ISA 寄存器 {\tt misa}}{21}{subsection.3.1.1}%
\contentsline {subsection}{\numberline {3.1.2}机器厂商ID寄存器 {\tt mvendorid}}{24}{subsection.3.1.2}%
\contentsline {subsection}{\numberline {3.1.3}机器架构ID寄存器{\tt marchid}}{25}{subsection.3.1.3}%
\contentsline {subsection}{\numberline {3.1.4}机器实现ID寄存器 {\tt mimpid}}{25}{subsection.3.1.4}%
\contentsline {subsection}{\numberline {3.1.5}硬件线程ID寄存器 {\tt mhartid}}{26}{subsection.3.1.5}%
\contentsline {subsection}{\numberline {3.1.6}机器状态寄存器 ({\tt mstatus} and {\tt mstatush})}{26}{subsection.3.1.6}%
\contentsline {subsubsection}{\numberline {3.1.6.1} {\tt mstatus} 寄存器中的特权和全局中断允许栈}{27}{subsubsection.3.1.6.1}%
\contentsline {subsubsection}{\numberline {3.1.6.2}Base ISA Control in {\tt mstatus} Register}{28}{subsubsection.3.1.6.2}%
\contentsline {subsubsection}{\numberline {3.1.6.3}{\tt mstatus}寄存器中的内存特权}{29}{subsubsection.3.1.6.3}%
\contentsline {subsubsection}{\numberline {3.1.6.4}{\tt mstatus}和{\tt mstatush}寄存器中的端序控制}{29}{subsubsection.3.1.6.4}%
\contentsline {subsubsection}{\numberline {3.1.6.5}{\tt mstatus}寄存器中的虚拟化支持}{31}{subsubsection.3.1.6.5}%
\contentsline {subsubsection}{\numberline {3.1.6.6}Extension Context Status in {\tt mstatus} Register}{31}{subsubsection.3.1.6.6}%
\contentsline {subsection}{\numberline {3.1.7}Machine Trap-Vector Base-Address Register ({\tt mtvec})}{35}{subsection.3.1.7}%
\contentsline {subsection}{\numberline {3.1.8}Machine Trap Delegation Registers ({\tt medeleg} and {\tt mideleg})}{36}{subsection.3.1.8}%
\contentsline {subsection}{\numberline {3.1.9}Machine Interrupt Registers ({\tt mip} and {\tt mie})}{38}{subsection.3.1.9}%
\contentsline {subsection}{\numberline {3.1.10}Hardware Performance Monitor}{40}{subsection.3.1.10}%
\contentsline {subsection}{\numberline {3.1.11}Machine Counter-Enable Register ({\tt mcounteren})}{41}{subsection.3.1.11}%
\contentsline {subsection}{\numberline {3.1.12}Machine Counter-Inhibit CSR ({\tt mcountinhibit})}{42}{subsection.3.1.12}%
\contentsline {subsection}{\numberline {3.1.13}Machine Scratch Register ({\tt mscratch})}{43}{subsection.3.1.13}%
\contentsline {subsection}{\numberline {3.1.14}Machine Exception Program Counter ({\tt mepc})}{43}{subsection.3.1.14}%
\contentsline {subsection}{\numberline {3.1.15}Machine Cause Register ({\tt mcause})}{44}{subsection.3.1.15}%
\contentsline {subsection}{\numberline {3.1.16}Machine Trap Value Register ({\tt mtval})}{47}{subsection.3.1.16}%
\contentsline {subsection}{\numberline {3.1.17}Machine Configuration Pointer Register ({\tt mconfigptr})}{48}{subsection.3.1.17}%
\contentsline {subsection}{\numberline {3.1.18}Machine Environment Configuration Registers ({\tt menvcfg} and {\tt menvcfgh})}{49}{subsection.3.1.18}%
\contentsline {subsection}{\numberline {3.1.19}Machine Security Configuration Register ({\tt mseccfg})}{50}{subsection.3.1.19}%
\contentsline {section}{\numberline {3.2}Machine-Level Memory-Mapped Registers}{51}{section.3.2}%
\contentsline {subsection}{\numberline {3.2.1}Machine Timer Registers ({\tt mtime} and {\tt mtimecmp})}{51}{subsection.3.2.1}%
\contentsline {section}{\numberline {3.3}Machine-Mode Privileged Instructions}{52}{section.3.3}%
\contentsline {subsection}{\numberline {3.3.1}Environment Call and Breakpoint}{52}{subsection.3.3.1}%
\contentsline {subsection}{\numberline {3.3.2}Trap-Return Instructions}{53}{subsection.3.3.2}%
\contentsline {subsection}{\numberline {3.3.3}Wait for Interrupt}{54}{subsection.3.3.3}%
\contentsline {subsection}{\numberline {3.3.4}Custom SYSTEM Instructions}{55}{subsection.3.3.4}%
\contentsline {section}{\numberline {3.4}Reset}{55}{section.3.4}%
\contentsline {section}{\numberline {3.5}Non-Maskable Interrupts}{56}{section.3.5}%
\contentsline {section}{\numberline {3.6}Physical Memory Attributes}{56}{section.3.6}%
\contentsline {subsection}{\numberline {3.6.1}Main Memory versus I/O versus Vacant Regions}{57}{subsection.3.6.1}%
\contentsline {subsection}{\numberline {3.6.2}Supported Access Type PMAs}{58}{subsection.3.6.2}%
\contentsline {subsection}{\numberline {3.6.3}Atomicity PMAs}{58}{subsection.3.6.3}%
\contentsline {subsubsection}{\numberline {3.6.3.1}AMO PMA}{58}{subsubsection.3.6.3.1}%
\contentsline {subsubsection}{\numberline {3.6.3.2}Reservability PMA}{59}{subsubsection.3.6.3.2}%
\contentsline {subsubsection}{\numberline {3.6.3.3}Alignment}{59}{subsubsection.3.6.3.3}%
\contentsline {subsection}{\numberline {3.6.4}Memory-Ordering PMAs}{60}{subsection.3.6.4}%
\contentsline {subsection}{\numberline {3.6.5}Coherence and Cacheability PMAs}{61}{subsection.3.6.5}%
\contentsline {subsection}{\numberline {3.6.6}Idempotency PMAs}{62}{subsection.3.6.6}%
\contentsline {section}{\numberline {3.7}Physical Memory Protection}{62}{section.3.7}%
\contentsline {subsection}{\numberline {3.7.1}Physical Memory Protection CSRs}{63}{subsection.3.7.1}%
\contentsline {subsection}{\numberline {3.7.2}Physical Memory Protection and Paging}{67}{subsection.3.7.2}%
\contentsline {chapter}{\numberline {第四章\hspace {.3em}}Supervisor-Level ISA, Version 1.12 监管者级指令集， 版本1.12}{69}{chapter.4}%
\contentsline {section}{\numberline {4.1}Supervisor CSRs 监管者CSR}{69}{section.4.1}%
\contentsline {subsection}{\numberline {4.1.1}Supervisor Status Register (\tt sstatus) 监管者级状态寄存器 (\tt sstatus)}{70}{subsection.4.1.1}%
\contentsline {subsubsection}{\numberline {4.1.1.1}Base ISA Control in {\tt sstatus} Register {\tt sstatus}寄存器中的基本控制}{72}{subsubsection.4.1.1.1}%
\contentsline {subsubsection}{\numberline {4.1.1.2}Memory Privilege in {\tt sstatus} Register {\tt sstatus}寄存器中的内存权限}{72}{subsubsection.4.1.1.2}%
\contentsline {subsubsection}{\numberline {4.1.1.3}Endianness Control in {\tt sstatus} Register {\tt sstatus}寄存器中的字节序控制}{74}{subsubsection.4.1.1.3}%
\contentsline {subsection}{\numberline {4.1.2}Supervisor Trap Vector Base Address Register ({\tt stvec}) 监管者级陷阱矢量基地址寄存器（{\tt stvec}）}{75}{subsection.4.1.2}%
\contentsline {subsection}{\numberline {4.1.3}Supervisor Interrupt Registers ({\tt sip} and {\tt sie}) 监管者级中断寄存器（{\tt sip}和{\tt sie}）}{76}{subsection.4.1.3}%
\contentsline {subsection}{\numberline {4.1.4}Supervisor Timers and Performance Counters 监管者级计时器和性能计数器}{80}{subsection.4.1.4}%
\contentsline {subsection}{\numberline {4.1.5}Counter-Enable Register ({\tt scounteren}) 计数器启用寄存器（{\tt scounteren}）}{80}{subsection.4.1.5}%
\contentsline {subsection}{\numberline {4.1.6}Supervisor Scratch Register ({\tt sscratch}) 监管者级Scratch寄存器（{\tt sscratch}）}{81}{subsection.4.1.6}%
\contentsline {subsection}{\numberline {4.1.7}Supervisor Exception Program Counter ({\tt sepc}) 监管者级异常程序计数器（{\tt sepc}）}{82}{subsection.4.1.7}%
\contentsline {subsection}{\numberline {4.1.8}Supervisor Cause Register ({\tt scause}) 监管者级原因寄存器（{\tt scause}）}{83}{subsection.4.1.8}%
\contentsline {subsection}{\numberline {4.1.9}Supervisor Trap Value ({\tt stval}) Register 监管者级陷阱值（{\tt stval}）寄存器}{84}{subsection.4.1.9}%
\contentsline {subsection}{\numberline {4.1.10}Supervisor Environment Configuration Register ({\tt senvcfg}) 监管者级环境配置寄存器（{\tt senvcfg}）}{87}{subsection.4.1.10}%
\contentsline {subsection}{\numberline {4.1.11}Supervisor Address Translation and Protection ({\tt satp}) Register 监管者地址转换和保护（{\tt satp}）寄存器}{90}{subsection.4.1.11}%
\contentsline {section}{\numberline {4.2}Supervisor Instructions 监管者指令}{95}{section.4.2}%
\contentsline {subsection}{\numberline {4.2.1}Supervisor Memory-Management Fence Instruction 监管者内存管理屏障指令}{96}{subsection.4.2.1}%
\contentsline {section}{\numberline {4.3}Sv32: Page-Based 32-bit Virtual-Memory Systems Sv32：基于页面的32位虚拟内存系统}{102}{section.4.3}%
\contentsline {subsection}{\numberline {4.3.1}Addressing and Memory Protection 寻址和内存保护}{103}{subsection.4.3.1}%
\contentsline {subsection}{\numberline {4.3.2}Virtual Address Translation Process 虚拟地址转换过程}{109}{subsection.4.3.2}%
\contentsline {section}{\numberline {4.4}Sv39: Page-Based 39-bit Virtual-Memory System Sv39：基于页面的39位虚拟内存系统}{114}{section.4.4}%
\contentsline {subsection}{\numberline {4.4.1}Addressing and Memory Protection 寻址和内存保护}{115}{subsection.4.4.1}%
\contentsline {section}{\numberline {4.5}Sv48: Page-Based 48-bit Virtual-Memory System Sv48：基于页面的48位虚拟内存系统}{117}{section.4.5}%
\contentsline {subsection}{\numberline {4.5.1}Addressing and Memory Protection 寻址和内存保护}{118}{subsection.4.5.1}%
\contentsline {section}{\numberline {4.6}Sv57: Page-Based 57-bit Virtual-Memory System Sv57：基于页面的57位虚拟内存系统}{119}{section.4.6}%
\contentsline {subsection}{\numberline {4.6.1}Addressing and Memory Protection 寻址和内存保护}{120}{subsection.4.6.1}%
\contentsline {chapter}{\numberline {第五章\hspace {.3em}}``Svnapot'' NAPOT翻译连续性的标准扩展，版本1.0}{123}{chapter.5}%
\contentsline {chapter}{\numberline {第六章\hspace {.3em}}用于基于页面的内存类型的标准扩展“Svpbmt”，版本1.0}{125}{chapter.6}%
\contentsline {chapter}{\numberline {第七章\hspace {.3em}}用于细粒度地址转换缓存失效的“Svinval”标准扩展，1.0版}{129}{chapter.7}%
\contentsline {chapter}{\numberline {第八章\hspace {.3em}}超级监管器拓展，1.0版}{133}{chapter.8}%
\contentsline {section}{\numberline {8.1}特权模式}{134}{section.8.1}%
\contentsline {section}{\numberline {8.2}超级监管器和虚拟监管器的控制状态寄存器}{135}{section.8.2}%
\contentsline {subsection}{\numberline {8.2.1}超级管理器状态寄存器({\tt hstatus})}{136}{subsection.8.2.1}%
\contentsline {subsection}{\numberline {8.2.2}超级监管级陷入委托寄存器 ({\tt hedeleg} 和 {\tt hideleg})}{138}{subsection.8.2.2}%
\contentsline {subsection}{\numberline {8.2.3}超级监管器中断寄存器 ({\tt hvip}， {\tt hip} 和 {\tt hie})}{139}{subsection.8.2.3}%
\contentsline {subsection}{\numberline {8.2.4}超级监管级宾客外部中断寄存器（{\tt hgeip} 和 {\tt hgeie}）}{141}{subsection.8.2.4}%
\contentsline {subsection}{\numberline {8.2.5}超级监管器环境配置寄存器（{\tt henvcfg} 和 {\tt henvcfgh}） }{143}{subsection.8.2.5}%
\contentsline {subsection}{\numberline {8.2.6}超级监管器计数器使能寄存器 （{\tt hcounteren}） }{144}{subsection.8.2.6}%
\contentsline {subsection}{\numberline {8.2.7}超级监管器时间偏移（Delta）寄存器（{\tt htimedelta}， {\tt htimedeltah}） }{144}{subsection.8.2.7}%
\contentsline {subsection}{\numberline {8.2.8}超级监管器陷入值寄存器（{\tt htval}）}{145}{subsection.8.2.8}%
\contentsline {subsection}{\numberline {8.2.9}超级监管器陷入指令寄存器（{\tt htinst}）}{146}{subsection.8.2.9}%
\contentsline {subsection}{\numberline {8.2.10}超级监管器宾客地址翻译和保护寄存器（{\tt hgatp}） }{146}{subsection.8.2.10}%
\contentsline {subsection}{\numberline {8.2.11}虚拟监管级状态寄存器 （{\tt vsstatus}）}{148}{subsection.8.2.11}%
\contentsline {subsection}{\numberline {8.2.12}虚拟监管级中断寄存器（{\tt vsip}和{\tt vsie}）}{149}{subsection.8.2.12}%
\contentsline {subsection}{\numberline {8.2.13}虚拟监管级陷入向量基地址寄存器（{\tt vstvec}）}{150}{subsection.8.2.13}%
\contentsline {subsection}{\numberline {8.2.14}虚拟监管级scratch寄存器（{\tt vsscratch}）}{151}{subsection.8.2.14}%
\contentsline {subsection}{\numberline {8.2.15}虚拟监管级异常程序计数器（{\tt vsepc}）}{151}{subsection.8.2.15}%
\contentsline {subsection}{\numberline {8.2.16}虚拟监管级原因寄存器（{\tt vscause}）}{151}{subsection.8.2.16}%
\contentsline {subsection}{\numberline {8.2.17}虚拟超级监管器陷入值寄存器（{\tt vstval}）}{152}{subsection.8.2.17}%
\contentsline {subsection}{\numberline {8.2.18}虚拟监管级地址翻译和保护寄存器 （{\tt vsatp}）}{152}{subsection.8.2.18}%
\contentsline {section}{\numberline {8.3}超级监管器指令}{153}{section.8.3}%
\contentsline {subsection}{\numberline {8.3.1}超级监管级虚拟机加载和存储指令}{153}{subsection.8.3.1}%
\contentsline {subsection}{\numberline {8.3.2}超级监管器内存管理屏障指令}{154}{subsection.8.3.2}%
\contentsline {section}{\numberline {8.4}机器级CSR}{156}{section.8.4}%
\contentsline {subsection}{\numberline {8.4.1}机器级状态寄存器（{\tt mstatus}和{\tt mstatush}）}{156}{subsection.8.4.1}%
\contentsline {subsection}{\numberline {8.4.2}机器中断代理寄存器（{\tt mideleg}）}{158}{subsection.8.4.2}%
\contentsline {subsection}{\numberline {8.4.3}机器中断寄存器（{\tt mip}和{\tt mie}）}{159}{subsection.8.4.3}%
\contentsline {subsection}{\numberline {8.4.4}机器第二陷入值寄存器（{\tt mtval2}）}{159}{subsection.8.4.4}%
\contentsline {subsection}{\numberline {8.4.5}机器陷入指令寄存器（{\tt mtinst}）}{160}{subsection.8.4.5}%
\contentsline {section}{\numberline {8.5}两阶段地址翻译}{160}{section.8.5}%
\contentsline {subsection}{\numberline {8.5.1}宾客物理地址翻译}{161}{subsection.8.5.1}%
\contentsline {subsection}{\numberline {8.5.2}宾客页错误}{163}{subsection.8.5.2}%
\contentsline {subsection}{\numberline {8.5.3}内存管理屏障}{163}{subsection.8.5.3}%
\contentsline {section}{\numberline {8.6}陷入}{164}{section.8.6}%
\contentsline {subsection}{\numberline {8.6.1}陷入原因编码}{164}{subsection.8.6.1}%
\contentsline {subsection}{\numberline {8.6.2}陷入实体}{168}{subsection.8.6.2}%
\contentsline {subsection}{\numberline {8.6.3}为{\tt mtinst} 或 {\tt htinst}的转换指令或伪指令}{169}{subsection.8.6.3}%
\contentsline {subsection}{\numberline {8.6.4}陷入返回}{174}{subsection.8.6.4}%
\contentsline {chapter}{\numberline {第九章\hspace {.3em}}RISC-V 特权指令集列表 }{175}{chapter.9}%
\contentsline {chapter}{\numberline {第十章\hspace {.3em}}历史 }{177}{chapter.10}%
\contentsline {section}{\numberline {10.1} 加州大学伯克利分校的研究经费 }{177}{section.10.1}%
